<!doctype html>
<!-- thanks to Akquinet, Qlik2Go https://github.com/q2g/q2g-web-jwtproxyredirect -->
<html>
<head>
	<link rel="stylesheet" href="login.css">
	<title>Qlik Sense Redirect Mashup</title>
	<meta charset="utf-8">
	<script src="../../resources/assets/external/requirejs/require.js"></script>
	<script>
	var hrefArr = window.location.href.split("?");
	var bearer = hrefArr[1].split("=")[1];
	console.log(bearer);
	$.getJSON( "./config.json", function( config ) {
		console.log(config);
		$.ajax({
			type: "GET",
			beforeSend: function(request) {
					request.setRequestHeader("Authorization", "Bearer " + bearer);
			},
			url: "https://" + config.host + "/" + config.proxy + "/hub",
			success: function() {
					window.location.replace("https://" + config.host + "/" + config.proxy + "/hub");
			},
			error: function (error) {
				console.log("error", error);
			}
		});
	});
	</script>
</head>
<body>
	<div class="sense-login-container">
		<div class="qlik-logo">
            <img src="./logo.png"> 
        </div>
		Got a token? Try it.
		<form method="GET">
	 		<input name="token" class="lui-input qlik-username">
	  		<input type="submit" id="loginbtn" class="lui-button qlik-submit" value="Log in" />
		</form>
	</div>
</body>
</html>